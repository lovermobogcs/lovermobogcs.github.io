<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Weather Widget</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 10px;
    }
    .weather {
      border: 1px solid #ccc;
      padding: 10px;
      display: inline-block;
      background: #f0f8ff;
      border-radius: 10px;
      max-width: 300px;
    }
    .icon {
      width: 64px;
      height: 64px;
    }
  </style>
</head>
<body>
  <div class="weather" id="weather">
    Loading weather...
  </div>

  <script>
    async function getWeather() {
      const url = "https://api.open-meteo.com/v1/forecast?latitude=52.4814&longitude=-1.8998&daily=sunrise,sunset&hourly=temperature_2m,precipitation,wind_speed_10m,relative_humidity_2m&models=ukmo_seamless&current=temperature_2m,relative_humidity_2m,is_day,precipitation,weather_code&timezone=auto&wind_speed_unit=mph";

      const iconMap = {
        0: "☀️",          // Clear sky
        1: "🌤️",         // Mainly clear
        2: "⛅",          // Partly cloudy
        3: "☁️",          // Overcast
        45: "🌫️",         // Fog
        48: "🌫️",         // Depositing rime fog
        51: "🌦️",         // Light drizzle
        53: "🌦️",         // Moderate drizzle
        55: "🌧️",         // Dense drizzle
        56: "🌧️",         // Light freezing drizzle
        57: "🌧️",         // Dense freezing drizzle
        61: "🌦️",         // Slight rain
        63: "🌧️",         // Moderate rain
        65: "🌧️",         // Heavy rain
        66: "🌧️❄️",       // Freezing rain
        67: "🌧️❄️",       // Heavy freezing rain
        71: "🌨️",         // Snow fall slight
        73: "🌨️",         // Moderate snow
        75: "❄️",          // Heavy snow
        77: "🌨️",         // Snow grains
        80: "🌦️",         // Rain showers slight
        81: "🌧️",         // Rain showers moderate
        82: "🌧️",         // Rain showers violent
        85: "🌨️",         // Snow showers slight
        86: "❄️",          // Snow showers heavy
        95: "⛈️",          // Thunderstorm
        96: "⛈️",          // Thunderstorm with hail
        99: "⛈️❄️"         // Thunderstorm with heavy hail
      };

      try {
        const response = await fetch(url);
        const data = await response.json();
        const weather = data.current;
        const daily = data.daily;

        const icon = iconMap[weather.weather_code] || "❓";

        const html = `
          <h3>Birmingham Weather</h3>
          <div style="font-size: 48px">${icon}</div>
          <p><strong>Temperature:</strong> ${weather.temperature_2m} °C</p>
          <p><strong>Humidity:</strong> ${weather.relative_humidity_2m} %</p>
          <p><strong>Precipitation:</strong> ${weather.precipitation} mm</p>
          <p><strong>Sunrise:</strong> ${daily.sunrise[0].split("T")[1]}</p>
          <p><strong>Sunset:</strong> ${daily.sunset[0].split("T")[1]}</p>
        `;

        document.getElementById("weather").innerHTML = html;
      } catch (error) {
        document.getElementById("weather").innerHTML = "Error loading weather.";
        console.error(error);
      }
    }

    getWeather();
  </script>
</body>
</html>
